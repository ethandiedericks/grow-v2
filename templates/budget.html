{% extends '_base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}
    Budget
{% endblock title %}

{% block content %} 

<div class="budget-container">
    <div class="row p-4">
        <div class="text-center mb-4">
            <h1>Personal Budget</h1>
        </div>

        <!-- incomes sources form -->
        <div class="col-md-6 p-4">
            <h2>Income Sources</h2>
            <form method="post">
                {% csrf_token %}
                {{ income_form | crispy }}
                <button type="submit" name="income_submit" class="btn btn-custom">Add Income</button>
            </form>

            <!-- display existing incomes -->
            <div class="mt-4">
                <h3>Existing Incomes</h3>
                <ul>
                    {% for income in incomes %}
                        <li>
                            {{ income.income_name }} - {{ income.income_amount }}
                            <a href="{% url 'delete_income' income.id %}"><i class="fa-solid fa-trash" style="color: #dc3545;"></i></a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <!-- expense form -->
        <div class="col-md-6 p-4">
            <h2>Expenses</h2>
            <form method="post" class="expense-form">
                {% csrf_token %}
                {{ expense_form | crispy }}
                <button type="submit" name="expense_submit" class="btn btn-danger">Add Expense</button>
            </form>
            <!-- display existing expenses -->
            <div class="mt-4">
                <h3>Existing Expenses</h3>
                <ul>
                    {% for expense in expenses %}
                        <li>
                            {{ expense.expense_name }} - {{ expense.expense_amount }}
                            <a href="{% url 'delete_expense' expense.id %}"><i class="fa-solid fa-trash" style="color: #dc3545;"></i></a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-6 p-4">
            <h4>Total Income: {{ total_income }}</h4>
        </div>
        <div class="col-md-6 p-4">
            <h4>Total Expenses: {{ total_expenses }}</h4>
            <h4>Remaining Balance: {{ remaining_balance }}</h4>
        </div>
    </div>
</div>

{% endblock content %}